# Default values for neutree.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

global:
  # Global image registry for all components
  # When set, this registry will be used for:
  # - All main chart components (api, core, db, auth, etc.) via global.image.registry
  # - Victoria Metrics Cluster (via global.image.registry)
  # - Grafana (via global.imageRegistry)
  # Note: To use a unified registry, global.image.registry should equal global.imageRegistry.
  image:
    registry: ""
  imageRegistry: ""

jwtSecret: "mDCvM4zSk0ghmpyKhgqWb0g4igcOP0Lp"
# the password for the neutree admin user.
# it is valid when starting neutree core for the first time.
# It is recommended to change it quickly after installation.
adminPassword: ""
imagePullSecrets: []

system:
  grafana:
    url: ""

metrics:
  # Specify the URL for remote write if using an external metrics storage system.
  # Leave this empty to use the embedded Victoria Metrics cluster.
  remoteWriteUrl: ""

k8sWaitFor:
  image:
    registry: ghcr.io
    repository: groundnuty/k8s-wait-for
    tag: "v2.0"
    pullPolicy: IfNotPresent

dbScripts:
  image:
    registry: ""
    repository: neutree/neutree-db-scripts
    tag: ""
    pullPolicy: IfNotPresent

db:
  image:
    registry: ""
    repository: postgres
    tag: "13"
    pullPolicy: IfNotPresent
  user: postgres
  password: pgpassword
  name: neutree
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 2
      memory: 2Gi
  persistence:
    enabled: true
    size: 40Gi
    accessModes:
      - ReadWriteOnce
  service:
    type: ClusterIP
  nodeSelector: {}
  tolerations: []
  affinity: {}

auth:
  image:
    registry: ""
    repository: supabase/gotrue
    tag: "v2.170.0"
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
  nodeSelector: {}
  tolerations: []
  affinity: {}
  service:
    type: ClusterIP

migration:
  image:
    registry: ""
    repository: migrate/migrate
    tag: v4.18.3
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
  nodeSelector: {}
  tolerations: []
  affinity: {}

postgrest:
  image:
    registry: ""
    repository: postgrest/postgrest
    tag: v14.0
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
  nodeSelector: {}
  tolerations: []
  affinity: {}
  service:
    type: ClusterIP

postgresmeta:
  image:
    registry: ""
    repository: supabase/postgres-meta
    tag: "v0.86.0"
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
  nodeSelector: {}
  tolerations: []
  affinity: {}
  service:
    type: ClusterIP

core:
  image:
    registry: ""
    repository: neutree/neutree-core
    tag: ""
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
  nodeSelector: {}
  tolerations: []
  affinity: {}
  server:
    service:
      type: ClusterIP

api:
  image:
    registry: ""
    repository: neutree/neutree-api
    tag: ""
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
  replicaCount: 1
  nodeSelector: {}
  tolerations: []
  affinity: {}
  service:
    type: ClusterIP

vmagent:
  image:
    registry: ""
    repository: victoriametrics/vmagent
    tag: "v1.115.0"
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
  nodeSelector: {}
  tolerations: []
  affinity: {}
  persistence:
    enabled: true
    size: 1Gi
    accessModes:
      - ReadWriteOnce

kong:
  image:
    registry: ""
    repository: kong/kong
    tag: "3.9"
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 1
      memory: 2Gi
  nodeSelector: {}
  tolerations: []
  affinity: {}
  proxyService:
    type: LoadBalancer

vector:
  image:
    registry: ""
    repository: timberio/vector
    tag: 0.47.0-debian
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
  nodeSelector: {}
  tolerations: []
  affinity: {}

jwtCli:
  image:
    registry: ""
    repository: bitnami/jwt-cli
    tag: 6.2.0
    pullPolicy: IfNotPresent

victoria-metrics-cluster:
  enabled: true
  # global.image.registry is inherited from parent chart's global.image.registry
  vmselect:
    replicaCount: 1
  vminsert:
    replicaCount: 1
    service:
      type: LoadBalancer
  vmstorage:
    replicaCount: 1
    persistentVolume:
      size: 40Gi

grafana:
  enabled: true
  # Grafana will automatically use global.imageRegistry from parent chart
  deploymentStrategy:
    type: Recreate
  image:
    # -- The Docker registry
    registry: "docker.io"
    # -- Docker image repository
    repository: grafana/grafana
    # Overrides the Grafana image tag whose default is the chart appVersion
    tag: "11.5.3"

  testFramework:
    enabled: false

  persistence:
    enabled: true
    size: 1Gi

  initChownData:
    enabled: false

  grafana.ini:
    auth.anonymous:
      enabled: true
    dashboards:
    # Path to the default home dashboard. If this value is empty, then Grafana uses StaticRootPath + "dashboards/home.json"
      default_home_dashboard_path: /var/lib/grafana/dashboards/default_grafana_dashboard.json
    analytics:
      check_for_plugin_updates: false
      check_for_updates: false
      enabled: false
      reporting_enabled: false
    plugins:
      public_key_retrieval_disabled: true
    security:
      preinstall_disabled: true
      allow_embedding: true
    grafana_net:
      url: ""
  dashboardProviders:
    dashboardproviders.yaml:
      - name: neutree
        orgId: 1
        folder: ''
        type: file
        options:
          path: /var/lib/grafana/dashboards
  assertNoLeakedSecrets: false

  adminUser: admin
  adminPassword: admin

  extraConfigmapMounts:
  - name: datasources
    mountPath: /etc/grafana/provisioning/datasources
    configMap: grafana-datasources
    readOnly: true
    optional: false
  - name: dashboards
    mountPath: /var/lib/grafana/dashboards
    configMap: grafana-dashboards
    readOnly: true
  service:
    enabled: true
    type: LoadBalancer





